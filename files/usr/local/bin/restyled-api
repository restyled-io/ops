#!/bin/sh
set -eu

if [ -z "$1" ]; then
  cat >&2 <<EOM
Usage: restyled-api <path> [curl_option..]

  Environment:

    RESTYLED_API_TOKEN    Required, API token with accesses you need
    RESTYLED_API_HOST     Optional, defaults to https://restyled.io

EOM
  exit 64
fi

path=$1
shift

: "${RESTYLED_API_HOST=https://restyled.io}"

url=$RESTYLED_API_HOST$path

exec curl --silent --fail \
  --header "Accept: application/json" \
  --header "Content-type: application/json" \
  --header "Authorization: token $RESTYLED_API_TOKEN" \
  "$@" "$url"
