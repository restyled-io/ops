#!/bin/sh
if [ -z "$1" ]; then
  cat >&2 <<EOM

Usage: docker-tag-push SOURCE_IMAGE[:TAG] [TARGET_IMAGE[:TAG]]

Create a tag TARGET_IMAGE (defaults to SOURCE_IMAGE) and push it
EOM
  exit 64
fi

source_image=$1
target_image=${2:-$source_image}

if docker tag "$source_image" "$target_image"; then
  docker push "$target_image"
else
  exit 1
fi
